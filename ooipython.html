<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Python Bindings for HybMesh &#8212; HybMesh 0.5.1 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="C++ Bindings for HybMesh" href="ooicpp.html" />
    <link rel="prev" title="Functions reference" href="ooifuncref.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ooicpp.html" title="C++ Bindings for HybMesh"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ooifuncref.html" title="Functions reference"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HybMesh 0.5.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="oointerface.html" accesskey="U">High-Level Programming Interfaces</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="python-bindings-for-hybmesh">
<span id="ooipython"></span><h1>Python Bindings for HybMesh<a class="headerlink" href="#python-bindings-for-hybmesh" title="Permalink to this headline">¶</a></h1>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Python wrapper contains a source file <code class="docutils literal"><span class="pre">Hybmesh.py</span></code>
and shared library <code class="docutils literal"><span class="pre">core_hmconnection_py</span></code>.
To use it in your application (either Python 2 or Python 3)
simply copy the source file into application directory and import
it as normal python file as</p>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Hybmesh</span> <span class="kn">import</span> <span class="n">Hybmesh</span>
</pre></div>
</div>
<p>Shared library can be left where it is.
Its absolute path along with absolute
path to installed hybmesh executable is
written into <strong>Hybmesh.hybmesh_lib_path</strong> and
<strong>Hybmesh.hybmesh_exec_path</strong> static properties respectively.
Those fields can be reassigned before first construction of
<strong>Hybmesh</strong> object if default values are not correct.</p>
<p><strong>Hybmesh</strong> class supports creation under python <code class="docutils literal"><span class="pre">with</span></code>
statement. By calling it as</p>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Hybmesh</span> <span class="kn">import</span> <span class="n">Hybmesh</span>

<span class="k">with</span> <span class="n">Hybmesh</span><span class="p">()</span> <span class="k">as</span> <span class="n">hm</span><span class="p">:</span>
    <span class="c1"># ... operations ...</span>
</pre></div>
</div>
<p>it is guaranteed that superclass object will
be destroyed immediately at the end of <code class="docutils literal"><span class="pre">with</span></code> block and
hybmesh subprocess will be closed.
Otherwise the subprocess will wait until
garbage collector executes superclass destructor.</p>
<p>For detailed description of all methods consult
<a class="reference internal" href="oointerface.html#ooifuncref"><span class="std std-ref">python wrapper reference</span></a>
and embedded documentation of <code class="docutils literal"><span class="pre">Hybmesh.py</span></code> source file.</p>
</div>
<div class="section" id="helloworld-example">
<h2>Helloworld Example<a class="headerlink" href="#helloworld-example" title="Permalink to this headline">¶</a></h2>
<p>After installation of hybmesh create a directory
with copied <em>Hybmesh.py</em> and the following <em>hmtest.py</em> files.</p>
<div class="literal-block-wrapper container" id="id1">
<div class="code-block-caption"><span class="caption-text">hmtest.py</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Hybmesh</span> <span class="kn">import</span> <span class="n">Hybmesh</span>

<span class="k">with</span> <span class="n">Hybmesh</span><span class="p">()</span> <span class="k">as</span> <span class="n">hm</span><span class="p">:</span>
    <span class="n">g4</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">add_unf_rect_grid</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">g4dims</span> <span class="o">=</span> <span class="n">g4</span><span class="o">.</span><span class="n">dims</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;number of cells = {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g4dims</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>Run terminal command</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python hmtest.py
</pre></div>
</div>
</div>
<div class="section" id="introductory-example">
<h2>Introductory Example<a class="headerlink" href="#introductory-example" title="Permalink to this headline">¶</a></h2>
<p>The following example illustrates numerical
computation of an integral of a function (Gaussian hill) on a grid.</p>
<p>It uses <a class="reference internal" href="prototypes.html#circrect-grid"><span class="std std-ref">Square in Circle</span></a> prototype grid with three different
outer step sizes. For each cell of the grid it calculates approximate
center point, computes target function at that point and multiplies the result by
the cell area.</p>
<p>This code could be run both on Python 2 and Python 3
interpreters.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">Hybmesh</span> <span class="k">import</span> <span class="n">Hybmesh</span>

<span class="c1"># target function: Gaussian hill with the center at [0, 0]</span>
<span class="k">def</span> <span class="nf">expfun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.25</span><span class="p">))</span>



<span class="c1"># create Hybmesh connection under with block to guarantee</span>
<span class="c1"># its destruction after all</span>
<span class="k">with</span> <span class="n">Hybmesh</span><span class="p">()</span> <span class="k">as</span> <span class="n">hm</span><span class="p">:</span>

    <span class="c1"># loop over different outer step sizes</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]:</span>

        <span class="c1"># create rectangle-in-cirlce grid prototype</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">add_circ_rect_grid</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

        <span class="c1"># get vertices as plain 1D array</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">raw_vertices</span><span class="p">()</span>

        <span class="c1"># get cell-vertices table as plain array.</span>
        <span class="c1"># Here we already know that grid contains only quadrangular cells,</span>
        <span class="c1"># hence there is no need to call g.raw_tab(&quot;cell_dim&quot;) to know</span>
        <span class="c1"># how the plain cell_vert array should be subdivided.</span>
        <span class="n">cell_vert</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">raw_tab</span><span class="p">(</span><span class="s2">&quot;cell_vert&quot;</span><span class="p">)</span>

        <span class="c1"># calculating integral as the sum of cell areas multiplied by</span>
        <span class="c1"># cell center function values.</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">it</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">cell_vert</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">it</span><span class="p">):</span>
            <span class="c1"># ind contains four vertex indices for current cell</span>
            <span class="c1"># x, y - are respective x and y coordinates</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">ind</span><span class="p">))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">ind</span><span class="p">))</span>
            <span class="c1"># calculate function value at approximate cell center</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">expfun</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span>
            <span class="c1"># calculate area</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">area</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">*</span><span class="n">y3</span><span class="o">-</span><span class="n">y2</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">area</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h = </span><span class="si">{}</span><span class="s2">: integral = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python Bindings for HybMesh</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#helloworld-example">Helloworld Example</a></li>
<li><a class="reference internal" href="#introductory-example">Introductory Example</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ooifuncref.html"
                        title="previous chapter">Functions reference</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ooicpp.html"
                        title="next chapter">C++ Bindings for HybMesh</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ooipython.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ooicpp.html" title="C++ Bindings for HybMesh"
             >next</a> |</li>
        <li class="right" >
          <a href="ooifuncref.html" title="Functions reference"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HybMesh 0.5.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="oointerface.html" >High-Level Programming Interfaces</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, KalininEI.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
  </body>
</html>